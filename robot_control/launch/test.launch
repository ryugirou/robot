<?xml version="1.0" encoding="UTF-8"?>
<launch>
  <arg name="manager_name" default="nodelet_manager" />
  <arg name="nodelet_mode" default="standalone" /><!-- set to standalone if you want to use as node-->

  <include file="$(find robot_control)/config/machine/sim.machine"/>

  <group if="$(eval nodelet_mode=='load')">
    <node pkg="nodelet" type="nodelet" name="$(arg manager_name)" args="manager" machine="robot"/>
  </group>

  <node pkg="rqt_console" type="rqt_console" name="rqt_console" machine="laptop">
    <remap from="/rosout_agg" to="/rosout"/>
  </node>

   
  <node pkg="nodelet" type="nodelet" name="vel_control" 
  args="$(arg nodelet_mode) base_controller_plugins/Vel_control $(arg manager_name)" machine="robot">
    <param name="lower_limit" value="-13.0"/>
    <param name="upper_limit" value="0.0"/>
    <remap from="pos" to="base/motor0_cmd_vel"/>
    <remap from="vel" to="motor0_vel"/>
  </node> 


  <!-- CAN -->
  <node pkg="nodelet" type="nodelet" name="usb_can_node"
  args="$(arg nodelet_mode) can_plugins/UsbCanNode $(arg manager_name)" machine="robot">
    <param name="port" value="/dev/ttyUSB0"/>
  </node>

  <node pkg="nodelet" type="nodelet" name="can_handler" 
  args="$(arg nodelet_mode) can_plugins/CanHandler $(arg manager_name)" machine="robot">
    <param name="beta0" value="$(eval 0x4d4)"/>
    <param name="beta1" value="$(eval 0x4dc)"/>
    <param name="beta2" value="$(eval 0x5b4)"/>
    <param name="beta3" value="$(eval 0x4b0)"/>
    <remap from="beta/motor0_cmd_vel" to="base/motor0_cmd_vel"/>
    <remap from="beta/motor1_cmd_vel" to="base/motor1_cmd_vel"/>
    <remap from="beta/motor2_cmd_vel" to="base/motor2_cmd_vel"/>
    <remap from="beta/motor3_cmd_vel" to="base/motor3_cmd_vel"/>
  </node>

</launch>
